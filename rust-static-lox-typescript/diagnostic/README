DIAGNOSTIC CRATE OVERVIEW

The diagnostic crate powers richly formatted, colorized diagnostics for the Lox toolchain. It aims to mirror Rustâ€™s diagnostic style: clear headers, labeled spans, contextual source lines, and helpful notes/suggestions.

KEY CONCEPTS
1. Diagnostic holds the message, file path, labeled spans, and optional help/note text.
2. SourceMap owns files, converts between byte offsets and (line, col), and provides line content.
3. DiagnosticCode wraps typed error and warning codes with stable identifiers and severities.
4. DiagnosticEngine aggregates diagnostics and emits them with a shared SourceMap.

USING SPANS AND SOURCEMAP
Spans are byte ranges in a file. For ergonomic construction from (line, col), use Span::from_line_col with a SourceFile:

  use diagnostic::source_map::{SourceMap, Span};

  let mut sm = SourceMap::new();
  sm.add_file("src/main.rs", "println!(\"Count: {}\", counter);\n");
  let file = sm.get("src/main.rs").unwrap();
  let span = Span::from_line_col(1, 21, 7, file); // line 1, col 21, len 7

CREATING AND PRINTING A DIAGNOSTIC

  use diagnostic::{
    code::DiagnosticCode,
    diagnostic::{Diagnostic, LabelStyle},
    source_map::{SourceMap, Span},
    types::error::DiagnosticError,
  };

  let mut sm = SourceMap::new();
  let src = "fn main() { println!(\"Count: {}\", counter); }\n";
  sm.add_file("src/main.rs", src);

  let file = sm.get("src/main.rs").unwrap();

  let diag = Diagnostic::new(
      DiagnosticCode::Error(DiagnosticError::UndefinedVariable),
      "cannot find value `counter` in this scope".to_string(),
      "src/main.rs".to_string(),
    )
    .with_label(
      Span::from_line_col(1, 36, 7, file),
      Some("not found in this scope".to_string()),
      LabelStyle::Primary,
    )
    .with_help("a local variable with a similar name exists: `count`".to_string());

  let _ = diag.print(&sm);

USING THE ENGINE

  use diagnostic::DiagnosticEngine;

  let mut engine = DiagnosticEngine::new();
  engine.add_file("src/main.rs", src);
  engine.add(diag);
  engine.print_diagnostics();

TYPED CODES AND SEVERITIES
DiagnosticCode::Error and DiagnosticCode::Warning map to enums in diagnostic::types. Each variant exposes a stable code string (e.g., E0425) and a Severity (Error/Warning/Note/Help).

MORE EXAMPLES
- Multiple labels on a single diagnostic (primary + secondary)
- Custom context padding with with_context_padding(n)
- Help and Note messages for suggestions and clarifications

TESTING
Run `cargo test -p diagnostic` to see end-to-end examples. The tests print sample diagnostics covering simple through super-complex reports.
